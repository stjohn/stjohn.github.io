<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  	<title>Challenges, DuckieTown@Hunter, January 2020</title>
    <link type="text/css" rel="stylesheet" href="../../lehman.css" />
  <style type="text/css">
  	li {
  		  padding-bottom:	10px ;
  }
  </style>
</head>
<body>

<div>
<div style =  "float:right">
<img style =  "height:100" src="duckie.png"><br>
<!--<p style = "float:right"> <em><small>(Image: everythingbranded.com)</small></em>-->
</div>


<h1>Challenges<h1>
<h2>DuckieTown Workshop<br>
Hunter College<br>
January 2020</h2>
</div>


<div>
The challenges below are part of the DuckieTown@Hunter workshop in January 2020.
The four-day, hands-on workshop introduces challenges in autonomous navigation with Duckietown. <a href="http://duckietown.org">Duckietown</a> is a colorful, realistic, internationally used platform that makes research issues in autonomous driving accessible. This workshop was made possible by a <a href="http://services.google.com/fh/files/misc/2019_explorecsr_grantees.pdf">Google Award for Undergraduate Computer Science Research Focused Workshops for Women</a>.
</div>

<div>
<a id="monAM"></a>
<h3>Monday Morning</h3>
<hr>
<h2>Getting Started: Calibrations & Test Runs</h2>
<hr>

<p><b>Goal:</b> To drive a calibrated robot through both towns, using the joystick program.
<p><b>Equipment needed:</b>  Department linux laptop and duckieBot.

<hr>
<h3>Setting Up Your Laptop & DuckieTown Account</h3>

<p>
We are using the linux laptops from the 1001E laboratory (the CSci 127 lab).  Those from cart 1 have been the duckieTown softare already installed.  The laptops run Ubuntu Linux operating system. When you open the laptop, choose the "Computer Science Guest" account (the password is on the whiteboard).  On the left hand side is a bar of icons, including icons for a browser (for accessing webpages) and the terminal window (for writing commands and launching programs).  

<p> For the morning session, we are following <a href="https://docs.duckietown.org/DT19/opmanual_duckiebot/out/index.html">Duckiebot operation manual</a>.
We have the software loaded, so, we're skipping ahead in the Duckiebot assembly and setup.
<p>Go to the documentation  page  for creating a  duckieTown account:

<blockquote>
<a href="
https://docs.duckietown.org/DT19/opmanual_duckiebot/out/dt_account.html">
Duckie Op Manual C-2: Duckietown account</a>
</tt>
</blockquote>
Our regional community is New York.  Make sure to include your institution as Hunter College.   
Having an account allows you to create tokens to use the dashboard (next section).  You can copy the token by highlighting it and then clicking CTRL-Shift-C (and pasting by CTRL-Shift-V).

<p>Much of our work will done via the terminal window.  Click the icon on the left for the terminal (looks like a computer).  It will launch a terminal window in which you can type commands.

<p>
To set up your token, type at the terminal:

	<pre style = "background-color:lavender;width:400px">
$ dts tok set</pre>
	(The <tt>$</tt> represents the prompt at the command line-- no need to type it.)


<p>You can check to see that authentication worked, by typing at the terminal:
	<pre style = "background-color:lavender;width:400px">
$ dts challenges info</pre>


<p>
Make sure you are on the wifi, <tt>duckieworkshop</tt>; the password is on the  whiteboard.  The duckiebots are connected to that wifi.


<p>
Open up two terminal windows.   
Opening a duckietown shell (dts) on the linux laptop (note: use terminal + chrome browser),

<h3>Setting Up DuckieBots</h3>

<p>Check out a duckieBot, ping the duckieBot, monitor the containers loaded, 
<ul>
	<li> Remember to take the lens cap off and put in box.
	<li> Gently plug in the two battery cables.
	<li> If the lights don't automatically already turns on, double click the side button 
</ul>	
	
<p>Check to see the robot is turned on and on the wifi:

<p style = "background-color:lavender;width:400px">
<tt>
$ping <span style="color:indigo">DUCKIEBOT_NAME</span>.local
</tt>
</p>
where <span style="color:indigo">DUCKIEBOT_NAME</span> is <tt>hunterbotXX</tt> with XX as the number of your bot.   To stop the messages, type CTRL-C.

<p>
To launch the dashboard, open up Chrome (Firefox will work but flicker a bit):
<ul>
	<li> Click on + key to open a new tab.
	<li> At the navigation bar, type:  <span style="color:indigo">DUCKIEBOT_NAME</span>.local
	<li> You will be prompted for your token, cut-and-paste it into the text-area.
	<li> Click on the <tt>Mission Control</tt> tab.   Open the default mission.
</ul>
You should see several graphs and the camera output, but we need to load more onto the bot to be able to move.

<p>To make the duckieBot move, we're following the directions:
<blockquote>
<a href="https://docs.duckietown.org/DT19/opmanual_duckiebot/out/rc_control.html">
Duckie Op Manual C-7: Making your Duckiebot move</a>
</blockquote>

<p>
After you tested the joy stick, go on to loading the camera software:
<blockquote>
<a href="https://docs.duckietown.org/DT19/opmanual_duckiebot/out/read_camera_data.html">
Duckie Op Manual C-8: Duckie Op Manual C-8: See what your DuckieBot sees</a>
</blockquote>

<p>

<h3>Calibrating Cameras</h3>

<p>
Now, we can calibrate the camera.  To do so, you will need a calibration sheet (checkerboard patterned laminated paper).  
<blockquote>
<a href="https://docs.duckietown.org/DT19/opmanual_duckiebot/out/camera_calib.html">
Duckie Op Manual C-9:  Camera calibration and validation</a>
</blockquote>

Notes on how to speed up calibration of cameras:
<ul>
	<li> Use a clipboard to hold the calibration sheet flat.
	<li> Put duckiebot at the edge of the table to get the "low" calibration points and makes it easier to get the far left and right.  
	<li> It won't turn green until all regions have a reading-- Move the calibration as high as possible (and still have highlighted colors on grid), as low, to far left and to far right as possible.   Also do the 4 "corners" of where it can see.  
	<li> Repeat this cycle 2 or 3 times, until calibration button lights up.
	<li> Hold the calibration sheet at each point for a count of 3 (too fast and it doesn't read it).
</ul>




<h3>Calibrating Wheels</h3>

Now, we can calibrate the wheels.  To do so, you will a long straight track (we have two marked in masking tape).  Each tile is about 2 feet or 60 centimeters long. 
<blockquote>
<a href="https://docs.duckietown.org/DT19/opmanual_duckiebot/out/wheel_calibration.html">
Duckie Op Manual C-10:  Wheel calibration</a>
</blockquote>

<h3>Driving with Joystick</h3>

Now that everything is calibrated, use the joystick to make a complete lap of both tracks.  Be careful not to run into other bots.

<p>
When you're done with your robot, gently disconnect the battery cables.


<hr>
<h3>Extra Challenges</h3>

<ul>
	<li><b>Dashboard Measures</b>  What do the monitors on the dashboard measure?  With the joystick controls, drive your duckie.  Which monitor measure velocity?  What happens when you drive "backwards"?
	<li><b>What does the camera see?</b>  what does the camera see?  Launch the video debug feed.  Taking a photo (can this be done just from dts, or do we need to load a program?)
	<li><b>Portainers:</b>
</ul>
 
</div>

<div>
<a id="monPM"></a>
<h3>Monday Afternoon</h3>
<hr>
<h2>Lane Following Demos</h2>
<hr>
<p><b>Goal:</b> Run and understand the structure of the lane following demo.

<p><b>Equipment needed:</b>  Department linux laptop and duckieBot.
<hr>

<h3>Overview of Software Architecture</h3>


<p>Add in somewhere portainers:  DUCKIEBOT_NAME.local:9000

<p>
First duckieTown programs:
Basics of programs in duckieTown:  software architecture (extra layers of containers & downloading to robots),  using git to pull down repos, set-up, how to edit, building and installing on robots (2 high-level slides (5 minutes) and then work through Jacopo’s intro (45 minutes)
Hello World: Run a program via the docker that says: Hello World (Unit C-5, Section 5.5, https://docs.duckietown.org/DT19/opmanual_duckiebot/out.pdf) https://github.com/duckietown/rpi-duckiebot-simple-python/blob/master18/hello.py  Better description in Jacopo’s class notes: https://docs.duckietown.org/daffy/duckietown-robotics-development/out/python_programs_environments.html
Work through:  https://docs.duckietown.org/DT19/software_devel/out/ros_commands.html
First duckieTown program:  go straight for 60 centimeters (one square) and stop.
Modify to include turns:  make at least 4 turns and return to the same spot.
Write out the commands to travel the entire track (only using turning, no camera capture).


<hr>
<h3>Extra Challenges</h3>
</div>

<div>
<a id="tueAM"></a>
<h3>Tuesday Morning</h3>
<hr>
<h2></h2>
<h2>Development Pipeline:  Using Git, Docker, Containers, and Python</h2>
<hr>
 Create a program, package it into a container, load on your bot, and run the program.
<hr>
<p><b>Goal:</b>
<p><b>Equipment needed:</b>  department linux laptop and duckieBot
<hr>
2.1 (Tuesday):  Line-following
Line-following demo-- download onto duckie
Modify to go a fixed amount of time, stop, and make a U-turn.
2.2 (Tuesday):  
2.3 (Tuesday):
<hr>
<h3>Extra Challenges</h3>
</div>

<div>
<a id="tuePM"></a>
<h3>Tuesday Afternoon</h3>
<hr>
<h2>Development Pipeline</h2>
<hr>
<p><b>Goal:</b>
<p><b>Equipment needed:</b>  department linux laptop and duckieBot

<h3>Extra Challenges</h3></div>
</div>

<div>
<a id="wedAM"></a>
<h3>Wednesday Morning</h3>
<hr>
<h2>Vision</h2>
<hr>
<p><b>Goal:</b>
<p><b>Equipment needed:</b>  department linux laptop and duckieBot
<hr>
3.1 (Paper, Wednesday morning):  Human Vision:
What do you see?  Several images of duck town-- describe everything you see in the image.
3.2 (Paper, Wednesday morning):  Robot Vision:
What can a robot see?  Same images-- but now think in terms of the vision system of the duckiebots.  
3.3 (Ducks, Wednesday morning):  Vision challenge with ducks
<hr>
<h3>Extra Challenges</h3></div>

<div>
<a id="wedPM"></a>
<h3>Wedneseday Afternoon</h3>
<hr>
<h2>Vision</h2>
<hr>
<p><b>Goal:</b>
<p><b>Equipment needed:</b>  department linux laptop and duckieBot
<hr>
3.4 (Paper, Wednesday afternoon):
3.5 (Ducks, Wednesday afternoon):  Find the pedestrian ducks (aka VisionZero:  don’t hit the ducks).

There's a demo:  
https://github.com/duckietown/Software/blob/master19/catkin_ws/src/70-convenience-packages/duckietown_demos/launch/obstacle_avoid.launchSoftware/
<hr>
<h3>Extra Challenges</h3></div>
</div>

<div>
<a id="thuAM"></a>
<h3>Thursday Morning</h3>
<hr>
<h2>Machine Learning & Ethics</h2>
<hr>
<p><b>Goal:</b>
<p><b>Equipment needed:</b>  department linux laptop and duckieBot
<hr>

<hr>
<h3>Extra Challenges</h3></div>

<div>
<a id="thuPM"></a>
<h3>Thursday Afternoon</h3>
<hr>
<h2>Machine Learning & Ethics</h2>
<hr>
<p><b>Goal:</b>
<p><b>Equipment needed:</b>  department linux laptop and duckieBot
<hr>

<hr>
<h3>Extra Challenges</h3></div>
</div>





<div>
<i>Last updated 11 January 2020.</i>
</div>

</html>